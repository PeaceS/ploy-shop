<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>ARTMUC Autumn 2025</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Thai:wght@100..900&family=Playfair+Display:ital,wght@0,400..900;1,400..900&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="/styles.css" />
  <script src="https://www.paypal.com/sdk/js?client-id=YOUR_PAYPAL_CLIENT_ID"></script>
</head>
<body>
  <h1>Bubble Merchandises</h1>

  <div id="product-container">
    <div class="product" id="product-template">
      <img id="product-image" />
      <h3 id="product-title"></h3>
      <p id="product-description"></p>
      <div id="paypal-button-container-1"></div>

      <form action="https://www.paypal.com/cgi-bin/webscr" method="post" target="_top">
        <input type="hidden" name="cmd" value="_s-xclick" />
        <input type="hidden" name="hosted_button_id" value="MZ36YKX95HERG" />
        <span id="product-price"></span>
        <span class="vat">(incl. 19% VAT)</span>
        <input type="hidden" name="currency_code" value="EUR" />
        <input class="button" type="image" src="https://www.paypalobjects.com/de_DE/i/btn/btn_buynow_SM.gif" border="0" name="submit" title="PayPal - The safer, easier way to pay online!" alt="Buy Now" />
      </form>
    </div>
  </div>

  <ul id="todo-list"></ul>

  <script>
    // paypal.Buttons({
    //   createOrder: function (data, actions) {
    //     return actions.order.create({
    //       purchase_units: [{
    //         amount: {
    //           value: '39.99'  // Change price here
    //         },
    //         description: 'Mini Canvas A'
    //       }]
    //     });
    //   },
    //   onApprove: function (data, actions) {
    //     return actions.order.capture().then(function (details) {
    //       alert('Thank you, ' + details.payer.name.given_name + '!');

    //       // Optional: Send to backend
    //       fetch('/api/submit-order', {
    //         method: 'POST',
    //         body: JSON.stringify(details),
    //         headers: {
    //           'Content-Type': 'application/json'
    //         }
    //       });
    //     });
    //   }
    // }).render('#paypal-button-container-1');
  
    async function fetchProducts() {
      try {
        const response = await fetch('/products');

        if (!response.ok) {
          throw new Error(`HTTP error! status: ${response.status}`);
        }

        const products = await response.json();
        const productContainer = document.getElementById('product-container');
        const productTemplate = document.getElementById('product-template');

        products.forEach(product => {
          const productDiv = productTemplate.cloneNode(true);
          productDiv.removeAttribute('id');

          titleDiv = productDiv.getElementById('product-title');
          titleDiv.textContent = product.item;

          imageDiv = productDiv.getElementById('product-image');
          imageDiv.src = product.image_url;
          imageDiv.alt = product.item;

          descriptionDiv = productDiv.getElementById('product-description');
          descriptionDiv.textContent = product.description;

          priceDiv = productDiv.getElementById('product-price');
          priceDiv.textContent = product.price;

          productContainer.appendChild(productDiv);
        });

        productContainer.removeChild(productTemplate);
      } catch (error) {
        console.error('Failed to fetch products:', error);
      }
    }

    fetchProducts();
  </script>
</body>
</html>
